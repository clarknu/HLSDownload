# M3U8视频下载器

这是一个用Python编写的M3U8视频下载工具，可以下载M3U8格式的视频并将其合成为单个视频文件。

## 功能特点

- 自动解析M3U8文件并下载所有视频分段
- 多线程并行下载，提高下载速度
- 自动使用URL的哈希值创建子文件夹，避免文件名冲突
- 下载完成后自动合并视频分段
- 提供下载进度、速度显示
- 支持清理临时文件

## 安装依赖

### Python依赖

使用pip安装所需的Python包：

```bash
pip install -r requirements.txt
```

### 外部依赖

本程序需要`ffmpeg`来合并视频分段，请确保已安装并添加到系统环境变量中。

- **Windows用户**：可以从[ffmpeg官网](https://ffmpeg.org/download.html)下载，解压后将bin目录添加到系统环境变量。
- **macOS用户**：可以使用Homebrew安装：`brew install ffmpeg`
- **Linux用户**：可以使用包管理器安装，例如Ubuntu：`sudo apt-get install ffmpeg`

## 使用方法

1. 确保已安装所有依赖
2. 运行程序：

```bash
python m3u8_downloader.py
```
3. 根据提示输入M3U8文件的网址
4. 程序会自动下载所有视频分段并合成为单个视频文件
5. 视频文件和临时文件会保存在以URL哈希值命名的子文件夹中

## 注意事项

- 本程序目前仅支持未加密的M3U8文件
- 如果下载过程中出现网络问题，部分分段可能下载失败，程序会提示是否继续合并
- 合并视频可能需要一定时间，具体取决于视频大小

## 程序流程

1. 用户输入M3U8文件的网址
2. 程序计算URL的哈希值并创建对应的子文件夹
3. 下载并解析M3U8文件，获取所有视频分段的URL
4. 多线程并行下载所有视频分段
5. 使用ffmpeg将所有视频分段合并为单个视频文件
6. 可选：清理临时的视频分段文件

## 常见问题

### Q: 为什么程序提示找不到ffmpeg？
A: 请确保已正确安装ffmpeg并添加到系统环境变量中。可以在命令行中输入`ffmpeg -version`来检查是否安装成功。

### Q: 下载的视频为什么无法播放？
A: 可能是因为M3U8文件是加密的，目前程序暂不支持解密功能。

### Q: 下载速度很慢怎么办？
A: 可以尝试修改程序中的`max_workers`参数，增加并行下载的线程数。